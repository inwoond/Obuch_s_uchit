# Проект: Обучение с учителем — Качество модели

## Описание проекта

Интернет-магазин «В один клик» продаёт разные товары: для детей, для дома, мелкую бытовую технику, косметику и даже продукты. Отчёт магазина за прошлый период показал, что активность покупателей начала снижаться. Привлекать новых клиентов уже не так эффективно: 
о магазине и так знает большая часть целевой аудитории. Возможный выход — удерживать активность постоянных клиентов. Сделать это можно с помощью персонализированных предложений.

«В один клик» — современная компания, поэтому её руководство не хочет принимать решения просто так — только на основе анализа данных и бизнес-моделирования. У компании есть небольшой отдел цифровых технологий, и вам предстоит побыть в роли стажёра в этом отделе.

Итак, вашему отделу поручили разработать решение, которое позволит персонализировать предложения постоянным клиентам, чтобы увеличить их покупательскую активность.

## Постановка задачи

- **Построить модель**, которая предскажет вероятность снижения покупательской активности клиента в следующие три месяца.
- **Выделить сегменты покупателей** и разработать для них персонализированные предложения, используя данные модели и данные о прибыльности клиентов.

## Как решать задачу

Задачу нужно решить в два этапа:

1. **Разработка модели**, которая предскажет вероятность снижения покупательской активности.
2. **Сегментация покупателей** и предложение мер по увеличению их активности.

**Подход к решению:**

- Промаркировать уровень финансовой активности постоянных покупателей.
- Собрать и проанализировать данные по различным группам признаков:
  - Коммуникация с клиентом.
  - Продуктовое поведение покупателя.
  - Покупательское поведение клиента.
  - Поведение покупателя на сайте.
- Построить модель машинного обучения для предсказания снижения активности.
- Используя данные модели и о прибыльности клиентов, выделить сегменты покупателей и разработать для них персонализированные предложения.

## Описание данных

Данные для работы находятся в нескольких таблицах:

### `market_file.csv`

Содержит данные о поведении покупателя на сайте, о коммуникациях с покупателем и его продуктовом поведении.

- `id` — номер покупателя в корпоративной базе данных.
- `Покупательская активность` — рассчитанный класс покупательской активности (целевой признак): «снизилась» или «прежний уровень».
- `Тип сервиса` — уровень сервиса, например «премиум» и «стандарт».
- `Разрешить сообщать` — информация о том, можно ли присылать покупателю дополнительные предложения о товаре.
- `Маркет_актив_6_мес` — среднемесячное значение маркетинговых коммуникаций за последние 6 месяцев.
- `Маркет_актив_тек_мес` — количество маркетинговых коммуникаций в текущем месяце.
- `Длительность` — сколько дней прошло с момента регистрации покупателя на сайте.
- `Акционные_покупки` — среднемесячная доля покупок по акции за последние 6 месяцев.
- `Популярная_категория` — самая популярная категория товаров у покупателя за последние 6 месяцев.
- `Средний_просмотр_категорий_за_визит` — сколько в среднем категорий покупатель просмотрел за визит в течение последнего месяца.
- `Неоплаченные_продукты_штук_квартал` — общее число неоплаченных товаров в корзине за последние 3 месяца.
- `Ошибка_сервиса` — число сбоев, которые коснулись покупателя во время посещения сайта.
- `Страниц_за_визит` — среднее количество страниц, которые просмотрел покупатель за один визит на сайт за последние 3 месяца.

### `market_money.csv`

Таблица с данными о выручке, которую получает магазин с покупателя.

- `id` — номер покупателя в корпоративной базе данных.
- `Период` — название периода, во время которого зафиксирована выручка (например, 'текущий_месяц' или 'предыдущий_месяц').
- `Выручка` — сумма выручки за период.

### `market_time.csv`

Данные о времени (в минутах), которое покупатель провёл на сайте в течение периода.

- `id` — номер покупателя в корпоративной базе данных.
- `Период` — название периода.
- `минут` — время, проведённое на сайте, в минутах.

### `money.csv`

Данные о среднемесячной прибыли покупателя за последние 3 месяца.

- `id` — номер покупателя в корпоративной базе данных.
- `Прибыль` — значение прибыли.

## Используемые модели

В ходе проекта были применены следующие модели машинного обучения:

- **KNeighborsClassifier**
- **DecisionTreeClassifier**
- **LogisticRegression**
- **SVC**
- **RandomForestClassifier** *(добавлена для улучшения точности)*

## Результаты

- **Лучшая модель:** RandomForestClassifier с оптимизированными гиперпараметрами.
- **Метрики качества:** Достигнута высокая точность и полнота при предсказании снижения покупательской активности.
- **Анализ важности признаков:** Использован метод SHAP для определения наиболее значимых признаков, влияющих на целевой признак.
- **Сегментация покупателей:** Выделены группы клиентов для персонализации предложений:
  - Клиенты с высокой долей покупок по акции и вероятностью снижения активности.
  - Клиенты, покупающие только технику (товары с длинным жизненным циклом).
  - Клиенты с высокой прибыльностью и вероятностью снижения активности.

## Предложения по увеличению покупательской активности

- **Персонализированные акции:** Предоставить специальные предложения и скидки для клиентов, склонных к покупкам по акциям.
- **Удержание прибыльных клиентов:** Разработать программы лояльности для наиболее прибыльных клиентов с риском снижения активности.
- **Расширение ассортимента:** Предложить дополнительные категории товаров клиентам, покупающим только определённые виды продукции.

## Как запустить проект

1. **Клонируйте репозиторий:**

   ```bash
   git clone https://github.com/your_username/supervised-learning-project.git
